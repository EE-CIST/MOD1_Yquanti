---
title: 'Application n°3'
---

```{r setup, echo=FALSE}
knitr::opts_chunk$set(echo = TRUE, message=FALSE, warning = FALSE)
```


```{r packages}
library(knitr)
library(dplyr, quietly = TRUE,warn.conflicts = F)
library(car,warn.conflicts = F,quietly=T)
library(sf)
library(mapsf)
library(RColorBrewer)

```

L'objectif de la présente analyse est d'analyser un tableau de **données individuelles** permettant de décrire le niveau de vie des ménages en fonction d'un certain nombre d'indicateurs endogènes ou exogènes. 


## A. DONNEES

Le jeu de données est un échantillon de variables relatives aux ménages du Bénin lors du RP 2013. Il s'agit plus précisément d'une extraction par tirage au sort de 100 ménages dans chacun des 546 arrondissements du Bénin. Le tirage au sort a été effectué en se limitant aux ménages composés d'au moins deux personnes, dont le chef de ménage est marié ou en union libre et dont les variables chosies ne comportent pas de valeurs manquantes ou non renseignés. La base de sondage se compose donc d'1.305 millions de ménages sur les 2 millions que compte le Bénin à cette date. L'échantillon comporte exactement 54600 lignes (100 pour chacun des 546 arrondissements).

Les variables ont été anonymisées en supprimant le numéro d'identification des ménages du recensement et en le remplaçant par le code de l'arrondissement suivi d'un chiffre de 001 à 100. Les variables les plus discriminantes ont vu leur nombre de modalité réduit. 

### Importation

On importe les données 

```{r}
don <- readRDS("BEN-MEN-2013/BEN-MEN-2013-SAMPLE.RDS")
kable(head(don), caption = "Premières lignes du tableau")
sum(don$WGT)
```

### Liste des variables

Le tableau comporte 47 variables

- **STRATES**
- ID : identifiant anonyme du ménage 
- WGT : poids du ménage 

- **POSITION GEOGRAPHIQUE**
- DEP : code du département
- DEP_NAME : nom du département
- COM : code de la commune
- COM_NAME : nom de la commune
- ARR : code de l'arrondissement
- ARR_NAME : nom de l'arrondissement
- URBA : statut de l'arrondissement (0 = rural, 1 = urbain)
- DEP_CHEF : arrondissement situé au chef-lieu du département (0 = non, 1 = oui)
- COM_CHEF : arrondissement situé au chef-lieu de la commune (0 = non, 1 = oui)
- COM_CHEF_DIST : distance de l'arrondissement au chef-lieu de sa commune (en km)
- DEP_CHEF_DIST : distance de l'arrondissement au chef-lieu de son département (en km)
- NAT_CHEF_DIST : distance de l'arrondissement à l'aéroport de Cotonu (en km)

- **STRUCTURE DU MENAGE**
- statoc : statut d'occupation (Propriété individuelle ou familiale, locataire, autre)
- tailmen : nombre de personnes recensées dans le ménage

- **ATTRIBUTS DU CHEF DE MENAGE**
- locnais : code de la commune de naissance (ou du département ou du pays étranger)
- datnais : année de naissance
- age : âge en différence de millésime
- sexe : sexe
- etud5 : niveau d'étude maximal (ramené à 5 modalités)

- **EQUIPEMENT DU MENAGE (présence ou absence) **
- radio : poste de radio
- telev : poste de télévision
- hifi  : chaîne HIFI       
- parab : parabole
- magne : magnetoscope
- cddvd : lecteur de CD-DVD       
- frigo : réfrigérateur      
- cuisi : cuisinière        
- foyam : foyer aménagé        
- ferre : fer à repasser        
- clima : climatiseur        
- venti : betilateur        
- lit   : lit       
- matel : matelas       
- faumo : fauteuril moderne        
- ordi  : ordinateur       
- inter : accès internet       
- elgen : générateur électrique       
- bicyc : bicyclette       
- motoc : motcyclette       
- voitu : coiture      
- barqu : barque, pirogue       
- telfix: téléphone fixe (au moins une ligne)   
- telmob: téléphone mobile (au moins un abonnement)


- **SYNTHESE DES EQUIPEMENTS**
- equip_tot : nombre total d'équipements différents (0 à 24)
- equip_acp : coordonnées sur le 1er axe factoriel d'une ACP sur les 24 équipements. 



### Fonds de carte

Nous disposons de quatre fonds de carte correspondant au découpage du Bénin à chacune des échelles d'analyse

```{r}
BEN0<-readRDS("BEN-MEN-2013/BEN-ADM0.RDS")
BEN1<-readRDS("BEN-MEN-2013/BEN-ADM1-DIST.RDS")
BEN2<-readRDS("BEN-MEN-2013/BEN-ADM2-DIST.RDS")
BEN3<-readRDS("BEN-MEN-2013/BEN-ADM3-DIST.RDS")
```


Il permet d'ores et déjà de repérer la position des départements, communes et arrondissements.

```{r,fig.height=8,fig.width=6}

mf_map(BEN1, type="typo",var="DEP_NAME")
mf_map(BEN3, type="base",col=NA,border="white",lwd=0.1,add=T)
mf_map(BEN2, type="base",col=NA,border="black",lwd=0.5,add=T)
mf_map(BEN1, type="base",col=NA,border="black",lwd=2,add=T)

```





## B. ANALYSE DU BORGOU




On choisit à titre d'exemple de limiter l'analyse au département de Borgou et d'étudier les facteurs de variation de l'indice d'équipement des ménages obtenu par analyse factorielle (*equip_acp*)

```{r}
sel<-don[don$DEP_NAME=="BORGOU",]
```


### VARIABLES ENDOGENES

On peut modéliser tout d'abord l'effet des variables relatives au ménage ou au chef de ménage


#### Sexe

```{r}
X<-sel$sexe
Y<-sel$equip_acp
nameX<-"Sexe"
nameY<-"Indice d'équipement (ACP)"
titre<-"Département de Borgou"
source<-"Source : RP2013, INS Bénin, échantillon aléatoire de 100 ménages"
mod<-lm(Y~X)

boxplot(Y~X, 
        main=titre,
        sub = source,
        xlab=nameX,
        ylab=nameY,
        col="lightyellow")
summary(mod)
```

- **Commentaire** : Aucun effet significatif (p >0.3)


#### Statut d'occupation

```{r}
X<-sel$statoc
Y<-sel$equip_acp
nameX<-"Statut d'occupation"
nameY<-"Indice d'équipement (ACP)"
titre<-"Département de Borgou"
source<-"Source : RP2013, INS Bénin, échantillon aléatoire de 100 ménages"
mod<-lm(Y~X)

boxplot(Y~X, 
        main=titre,
        sub = source,
        xlab=nameX,
        ylab=nameY,
        col="lightyellow")
summary(mod)


```

- **Commentaire** : Avantage significatif des locataires (p <0.001) mais cela révèle sans doute un effet urbain-rural. 


#### Classe d'âge

```{r}
sel$age5<-cut(sel$age, breaks=c(18,29,39,49,59,100),include.lowest = T)
levels(sel$age5)<-c("18-29", "30-39","40-49","50-59","60+")
X<-sel$age5
Y<-sel$equip_acp
nameX<-"Classe d'âge"
nameY<-"Indice d'équipement (ACP)"
titre<-"Département de Borgou"
source<-"Source : RP2013, INS Bénin, échantillon aléatoire de 100 ménages"
mod<-lm(Y~X)

boxplot(Y~X, 
        main=titre,
        sub = source,
        xlab=nameX,
        ylab=nameY,
        col="lightyellow")
summary(mod)


```

- **Commentaire** : Relation significative mais à très faible pouvoir explicatif. Effet non linéaire avec maximum d'équipement pour la classe d'âge des 40-49 ans. 


#### Niveau d'étude

```{r}
X<-sel$etud5
Y<-sel$equip_acp
nameX<-"Niveau d'étude"
nameY<-"Indice d'équipement (ACP)"
titre<-"Département de Borgou"
source<-"Source : RP2013, INS Bénin, échantillon aléatoire de 100 ménages"
mod<-lm(Y~X)

boxplot(Y~X, 
        main=titre,
        sub = source,
        xlab=nameX,
        ylab=nameY,
        col="lightyellow")
summary(mod)

```

- **Commentaire** : Relation très significative et à très fort pouvoir explicatif comparée aux précédentes (r2 = 23%). Il s'agit du facteur le plus déterminant parmi ceux qui ont été retenus


#### Taille du ménage


```{r}
X<-log(sel$tailmen)
Y<-sel$equip_acp
nameX<-"Taille du ménage (log)"
nameY<-"Indice d'équipement (ACP)"
titre<-"Département de Borgou"
source<-"Source : RP2013, INS Bénin, échantillon aléatoire de 100 ménages"
mod<-lm(Y~X)

plot(X,Y ,
        main=titre,
        sub = source,
        xlab=nameX,
        ylab=nameY)
abline(mod, col="red")
summary(mod)

```

- **Commentaire** : Relation significative mais à très faible pouvoir explicatif





### VARIABLES CONTEXTUELLES

Nous proposons maintenant une suite d'analyse portant sur les déterminants spatiaux en distinguant deux cas selon que la variable explicative est catégorielle ou selon qu'elle correspond à un effect continu d'éloignement.

#### Déterminants territoriaux

Les **déterminants territoriaux** correspondent au cas où la variable explicative est *catégorielle* et où l'effet sur le ménage est lié à son *appartenance* à un type d'espace. Ceci nous permet d'identifier trois variables :

- URBA : l'arrondissement où le ménage est situé est-il déclaré "rural" ou "urbain" par l'état ?
- DEF_CHEF : l'arrondissement où le ménage est situé est-il le siège d'un chef-lieu de département
- COM_CHEF : l'arrondissement où le ménage est situé est-il le siège d'un chef-lieu de commune

```{r}
map1<-BEN1[BEN1$DEP_NAME=="BORGOU",]
map2<-BEN2[BEN2$DEP_NAME=="BORGOU",]
map3<-BEN3[BEN3$DEP_NAME=="BORGOU",]
map3$URBA<-as.factor(map3$URBA)
levels(map3$URBA)<-c("Rural","Urbain")
map2ctr<-st_centroid(map3[map3$COM_CHEF==1 & map3$DEP_CHEF==0,])
map1ctr<-st_centroid(map3[ map3$DEP_CHEF==1,])

mf_map(map3,type="typo",var="URBA",pal=c("lightyellow","orange"), border="gray",lwd=0.3,leg_title = "Type d'espace")
mf_map(map2,type="base",col=NA, border="black",lwd=1, add=T)
mf_map(map1,type="base",col=NA, border="black",lwd=2, add=T)
mf_map(map2ctr,type="base",pch=20,col="blue",add=T)
mf_label(map2ctr,var = "COM_NAME", col="blue",pos=1)
mf_map(map1ctr,type="base",pch=15,col="red",add=T, cex=2)
mf_label(map1ctr,var = "COM_NAME", col="red",pos=1,cex = 1.2)
mf_layout(title = "Communes et arrondissements du Borgou",
          credits = "Source : EE CIST 2023",frame = T)
```

####  Urbain/Rural


L'attribution du caractère *urbain* ou *rural* à un arrondissement est le résultat d'une décision administrative de l'état. Elle se traduit dans le recensement de 2013 par l'ajout d'un code "5" en quatrième position du code de l'arrondissement. Il peut y avoir plusieurs arrondissements "urbains" à l'intérieur d'une même commune. Il peut également arriver que l'ensemble d'une commune soit composée d'arrondissements urbain comme c'est le cas pour Parakou. Les arrondissements urbains contigus portent en général le même nom suivi d'un numéro (PARAKOU 01, PARAKOU 02, PARAKOU 03, PARAKOU 04) et leur réunion forment implicitement une "ville" dans une logique administrative. Mais les contours de ces villes sont très différents de ceux que l'on pourrait obtenir par des sources non administratives telles que les images de télédétection utilisées par la base Africapolis où des données détaillées de mobilité à l'échelon indiviuel (non accessibles pour des raisons de secret statistique). 

Qu'elle reflète ou non une réalité morphologique (continuité du bâti) ou fonctionnelle (solde migratoire positif) n'est cependant pas ici la question principale. En revanche il peut être intéressant de se demander si les arrondissements urbains bénéficient d'un traitement privilégié de l'état, conduisant par exemple celui-ci à mettre en place des politiques publiques qui privilégient ces lieux en matière de déploiement d'infrastructures (écoles, lycées, cliniques, ...) ce qui peut attirer des populations plus riches ou plus éduquées, dotées d'un meilleur équipement. 


```{r}
sel$URBA<-as.factor(sel$URBA)
levels(sel$URBA)<-c("Rural","Urbain")
X<-sel$URBA
Y<-sel$equip_acp
nameX<-"Catégorisation administrative de l'arrondissement"
nameY<-"Indice d'équipement (ACP)"
titre<-"Département de Borgou"
source<-"Source : RP2013, INS Bénin"
mod<-lm(Y~X)

boxplot(Y~X, 
        main=titre,
        sub = source,
        xlab=nameX,
        ylab=nameY,
        col="lightyellow")
summary(mod)

```

- **Commentaire** : La relation obtenue est très significative (p<0.001) et son pouvoir explicatif est important (r2 = 11%).


#### Fonction administrative

Dans une logique légèrement différente, on peut se demander si les arrondissements qui remplissent des fonction de centralité administrative bénéficient d'un traitement privilégié de la part de l'état. Dans le cas du Bénin, tous les arrondissements qui sont centre de commune sont automatiquement déclarés urbains. Mais l'inverse n'est pas vrai et des arrondissements urbains peuvent ne pas être le siège d'un chef-lieu de commune ou de département. 

```{r}
sel$CHEF<-as.factor(sel$COM_CHEF+sel$DEP_CHEF)
levels(sel$CHEF)<-c("Aucune","Centre de commune", "Centre de département")
X<-sel$CHEF
Y<-sel$equip_acp
nameX<-"Fonction administraive"
nameY<-"Indice d'équipement (ACP)"
titre<-"Département de Borgou"
source<-"Source : RP2013, INS Bénin"
mod<-lm(Y~X)

boxplot(Y~X, 
        main=titre,
        sub = source,
        xlab=nameX,
        ylab=nameY,
        col="lightyellow")
summary(mod)

```

- **Commentaire** : La relation obtenue est très significative (p<0.001) même si son pouvoir explicatif est plus limité (r2 = 5%) que celui de l'opposition urbain-rural . On note un net accroissement du niveau d'équipement des ménages avec le niveau administraif de l'arrondissement où ils sont localisés (+0.32 pour un chef lieu de commune et +0.87 pour un chef lieu de département)




#### Accessibilité

Les **déterminants spatiaux** correspondent au cas où la variable explicative est de type *quantitatif continu* et où l'effet sur le ménage est lié à son *accessibilité* à une ressource c'est-à-dire à l'influence de la *distance*.  

```{r,fig.height=5,fig.width=8}
par(mfrow=c(1,2))
mypal<-brewer.pal(7,"RdYlGn")

## Distance à la commune
mybreaks=c(0,5,10,20,40,80, 160, 320)
mf_map(map3,
       type="choro",
       var="COM_CHEF_DIST",
       pal=mypal,
       breaks=mybreaks,
        border="gray",
       lwd=0.3,
       leg_title = "Distance(km)",
       leg_val_rnd = 0)


mf_map(map2,type="base",col=NA, border="black",lwd=2, add=T)
mf_map(map1,type="base",col=NA, border="black",lwd=2, add=T)
mf_map(map2ctr,type="base",pch=20,col="black",add=T)
mf_label(map2ctr,var = "COM_NAME", col="black",pos=1)
mf_map(map1ctr,type="base",pch=20,col="black",add=T, cex=1)
mf_label(map1ctr,var = "COM_NAME", col="black",pos=1)
mf_layout(title = "Accessibilité Communale",
          credits = "Source : EE CIST 2023",frame = T)


## Distance au dept
mybreaks=c(0,5,10,20,40,80, 160, 320)
mf_map(map3,
       type="choro",
       var="DEP_CHEF_DIST",
       pal=mypal,
       breaks=mybreaks,
        border="gray",
       lwd=1,
       leg_title = "Distance (km)",
       leg_val_rnd = 0)

#mf_map(map2,type="base",col=NA, border="black",lwd=1, add=T)
mf_map(map1,type="base",col=NA, border="black",lwd=2, add=T)
mf_map(map1ctr,type="base",pch=15,col="black",add=T, cex=1)
mf_label(map1ctr,var = "COM_NAME", col="black",pos=1)
mf_layout(title = "Accessibilité Départementale",
          credits = "Source : EE CIST 2023",frame = T)

summary(map3$NAT_CHEF_DIST)


```


### Accessibilité communale

On utilise une fonction puissance dela distance en ajoutant une valeur minimale de 1km correspondant à l'acccessibilité interne du centre.

$f(D_{ij})=\alpha\times (1+D_{ij})^{-\beta}$

```{r}
sel$log_Dis_COM<-log(1+sel$COM_CHEF_DIST)
X<-sel$log_Dis_COM
Y<-sel$equip_acp
nameX<-"Distance au centre de la commune (racine carrée)"
nameY<-"Indice d'équipement (ACP)"
titre<-"Département de Borgou"
source<-"Source : RP2013, INS Bénin"
mod<-lm(Y~X)

plot(X,Y ,
     pch=20,
     cex=0.4,
        main=titre,
        sub = source,
        xlab=nameX,
        ylab=nameY)
abline(mod, col="red")
summary(mod)

```

- **Commentaire** : La relation obtenue est très significative (p<0.001) même si son pouvoir explicatif est plus limité (r2 = 5.9%). Ceci s'explique tout d'abord  par l'incertitude de mesure : la distance utilisée est l'éloignement entre les arrondissements et non pas entre l'individu et le centre de sa commune. Mais aussi par la diversité des ménages en matière d'équipement quelle que soit la distance au centre. 


### Accessibilité départementale


```{r}
sel$log_Dis_DEP<-log(1+sel$DEP_CHEF_DIST)
X<-sel$log_Dis_DEP
Y<-sel$equip_acp
nameX<-"Distance au centre du département (racine carrée)"
nameY<-"Indice d'équipement (ACP)"
titre<-"Département de Borgou"
source<-"Source : RP2013, INS Bénin"
mod<-lm(Y~X)

plot(X,Y ,
     pch=20,
     cex=0.4,
        main=titre,
        sub = source,
        xlab=nameX,
        ylab=nameY)
abline(mod, col="red")
summary(mod)

```

- **Commentaire** : La relation obtenue demeure très significative (p<0.001) mais son pouvoir explicatif demeure limité (r2 = 4.8%). On peut toutefois se demander si la difficulté ne vient pas du fait que l'on emploie séparément les deux distances.


### SYNTHESE


#### Variables endogènes

```{r}


mod1<-lm(data=sel, equip_acp~sexe+age5+etud5+statoc+log(tailmen))


summary(mod1)
Anova(mod1, type="III")

```

- **Commentaire** : la combinaison des déterminants sociaux aboutit à un modèle où toutes les variables apportent une contribution significative au modèle à l'exception du sexe. L'analyse de variance de type III (toutes choses égales par ailleurs) confirme le rôle central du niveau de diplôme du chef de ménage qui est de lon la variable qui contribue le plus à l'explication du niveau d'équipement. La taille du ménage joue également un rôle ainsi que le statut d'occupation qui montre un meilleur équipement des locataires.


#### Variables contextuelles

```{r}


mod2<-lm(data=sel, equip_acp~URBA+CHEF+log_Dis_COM+log_Dis_DEP)


summary(mod2)
Anova(mod2, type="III")

```


- **Commentaire : ** le mélange des variables contextuelles est difficile à interpréter en raison ds fortes redondances qu'il y a entre certaines variables explicatives. En effet la variable URBA est corrélée avec le fait d'être ou pas un centre de commune ou de département. Tandis que la distance à la commune ou au chef lieu est corrélée avec le fait d'être ou non un chef-lieu de commune ou de district. Il faudra donc n'en retenir qu'une partie par la suite, mais le point intéressant est le pouvoir explicatif élevé du modèle (r2 = 15.4%) alors même qu'aucune caractéristique endogène des ménages n'est prise en compte. Dit autrement, la simple connaissance de l'arrondissement où est localisé un ménage permet de prédire la probabilité que son niveau d'équipement soit faible ou élevée. 



#### Variables endogènes et contextuelles

On construit un modèle final reprenant l'ensemble des variables endogènes mais en leur ajoutant les deux mesures d'accessibilité a au centre de commune ou de district. 


```{r}


mod3<-lm(data=sel, equip_acp~sexe+age5+etud5+statoc+log(tailmen)+log_Dis_COM+log_Dis_DEP)
summary(mod3)
Anova(mod3, type="III")

```


- **Commentaire** : Par rapport au modèle purement endogène de modélistion des comportements individuels par les attributs des ménages, le gain est assez faible en terme de qualité d'ajustement (passage de 27% à 30%). C'est plutôt au niveau de l'interprétation que le nouveau modèle est intéressant car il révèle que le niveau d'étude se combine étroitement dans l'explication avec l'accessibilité aux centres de commune ou de districts. Ce qui laisse soupçonner une interaction entre les deux facteurs


### Modèle final

Pour aboutir à un modèle final qui soit le plus simple possible, on ne retient que trois variables dont l'interprétation sera plus facile et que l'on peut associer à des hypothèses empiriquement vérifiables :

- H1 : Plus un ménage comporte de personnes, plus il a de chances de posséder un niveau d'équipement élevé. Mais l'accroissement de la relation n'est pas linéaire et suit une loi logarithmique.
- H2 : Plus le chef de ménage dispose d'un niveau d'éducation élevé, plus son ménage disposera d'un équipement élevé. Cette relation s'explique par le jeu combiné du capital économique et scolaire (Bourdieu) qui rend possible (capital économique) et désirable (capital scolaire) la possession d'équipements diversifiés.
- H3 : Plus un ménage est éloigné du centre de son département, moins il a de chances de pouvoir accéder à certains équipements en raison de déficits d'infrastructure (e.g. électricité) ou de difficulté à se les procurer. 


```{r}

mod4<-lm(data=sel, equip_acp~log(tailmen)+etud5+log_Dis_DEP)
summary(mod4)
Anova(mod4, type="III")

```


- **Commentaire**: notre modèle final met en valeur le rôle décisif du niveau d'étude (proxy du capital scolaire et économique) mais il confirme l'effet positif de la taille du ménage et l'effet négatif de la distance au centre de commandement du département. Son équation final peut s'écrire :


$I_{equipt} = -0.31 + \alpha_{Niv.scolaire} + 0.22\times log({taille du ménage}) -0.11\times log({accessibilité})$
